import{u as V,j as e,s as G}from"./index--ILSzZaw.js";import{r as p}from"./animation-vendor-B6fZrcjP.js";import{u as R}from"./levelStore-XI9ZHSFN.js";import{u as X}from"./playerStore-r_j1nxA9.js";import{u as J}from"./quizStore-Chk_mg7S.js";import{s as U,b as W}from"./levelService-DPZIrGbv.js";import{getLevelById as T,getQuizTypeMetadata as y}from"./level-DpoHUSSg.js";import{C as L}from"./Card-BK5bYxKM.js";import{B as k}from"./Button-Bl6cuHxx.js";import{I as Y}from"./Input-gL6nqdJo.js";import{H as Z}from"./Header-DyyfoM7s.js";import{S as B}from"./ScreenContainer-21a-fcYA.js";import{B as I}from"./BackButton-BDaTWkU4.js";import{O as g}from"./OptionButton-CxVbMwJ3.js";import"./react-vendor-labSKdyf.js";import"./ui-vendor-B8QmJS74.js";const ue=()=>{const{goToNext:u}=V(),{currentLevel:o,currentSubject:m,currentQuizType:a,filterSubject:n,filterQuizType:l,quizList:j,setQuizList:D,loadingQuizList:M,setLoadingQuizList:b,setFilterSubject:$,setFilterQuizType:z,clearFilters:E}=R(),{currentPlayer:F}=X(),{setSharedQuizId:K}=J(),[N,v]=p.useState(null),[h,H]=p.useState(""),[i,f]=p.useState("usage");p.useEffect(()=>{S()},[o,m,a,n,l,i]);const S=async()=>{try{b(!0),v(null);const t={levelId:o?.id,subjectId:n||m?.id,quizType:l||a,creatorId:a==="personal"?F?.id:null,sortBy:i};let r;h.trim()?r=await U(h.trim(),t):r=await W(t),D(r)}catch(t){console.error("Error loading quizzes:",t),v(t.message)}finally{b(!1)}},P=t=>{G.playClick(),K(t.id),u("quizSharePreview")},A=t=>{if(!t)return"Kh√¥ng r√µ";try{const r=new Date(t),s=new Date-r,c=Math.floor(s/6e4),x=Math.floor(s/36e5),Q=Math.floor(s/864e5);return c<1?"V·ª´a xong":c<60?`${c} ph√∫t tr∆∞·ªõc`:x<24?`${x} gi·ªù tr∆∞·ªõc`:Q<7?`${Q} ng√†y tr∆∞·ªõc`:r.toLocaleDateString("vi-VN",{year:"numeric",month:"short",day:"numeric"})}catch{return"Kh√¥ng r√µ"}},O=t=>{t.preventDefault(),S()},C=o?T(o.id):null,w=a?y(a):null;return M?e.jsx(B,{className:"flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-4 animate-spin",children:"‚è≥"}),e.jsx("p",{className:"text-xl text-gray-600",children:"ƒêang t·∫£i danh s√°ch b√†i test..."})]})}):e.jsxs(B,{children:[e.jsx(I,{inline:!0,variant:"ghost",label:"‚Üê Quay l·∫°i",onClick:()=>u("quizTypeSelect"),className:"mb-2"}),e.jsx(Z,{title:"Danh s√°ch b√†i test",subtitle:C&&m&&w?`${C.name} - ${m.name} - ${w.name}`:"Ch·ªçn c·∫•p ƒë·ªô, m√¥n h·ªçc v√† lo·∫°i",titleClassName:"text-4xl"}),e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("form",{onSubmit:O,className:"flex gap-2",children:[e.jsx(Y,{type:"text",value:h,onChange:t=>H(t.target.value),placeholder:"T√¨m ki·∫øm b√†i test...",className:"flex-1"}),e.jsx(k,{type:"submit",variant:"primary",children:"üîç"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"S·∫Øp x·∫øp:"}),e.jsx(g,{label:"Ph·ªï bi·∫øn",selected:i==="usage",onClick:()=>f("usage"),size:"sm"}),e.jsx(g,{label:"ƒê√°nh gi√° cao",selected:i==="rating",onClick:()=>f("rating"),size:"sm"}),e.jsx(g,{label:"M·ªõi nh·∫•t",selected:i==="newest",onClick:()=>f("newest"),size:"sm"})]}),(n||l)&&e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"B·ªô l·ªçc:"}),n&&e.jsxs("span",{className:"px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm",children:["M√¥n: ",n,e.jsx("button",{onClick:()=>$(null),className:"ml-2 hover:text-primary-900",children:"√ó"})]}),l&&e.jsxs("span",{className:"px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm",children:["Lo·∫°i: ",y(l)?.name,e.jsx("button",{onClick:()=>z(null),className:"ml-2 hover:text-primary-900",children:"√ó"})]}),e.jsx(k,{variant:"ghost",size:"sm",onClick:E,children:"X√≥a b·ªô l·ªçc"})]})]}),N&&e.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-xl text-red-800 text-sm",children:["‚ö†Ô∏è ",N]}),j.length===0?e.jsxs(L,{className:"text-center py-12",children:[e.jsx("div",{className:"text-6xl mb-4",children:"üì≠"}),e.jsx("p",{className:"text-xl text-gray-600 mb-2",children:"Ch∆∞a c√≥ b√†i test n√†o"}),e.jsx("p",{className:"text-sm text-gray-500",children:a==="personal"?"B·∫°n c√≥ th·ªÉ t·∫°o b√†i test m·ªõi t·ª´ Google Sheet":"H√£y quay l·∫°i sau"})]}):e.jsx("div",{className:"space-y-4",children:j.map((t,r)=>{const d=T(t.levelId),s=y(t.quizType);return e.jsx(L,{onClick:()=>P(t),className:"cursor-pointer",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[d&&e.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-semibold",children:[d.icon," ",d.name]}),s&&e.jsxs("span",{className:`px-2 py-1 bg-gradient-to-r ${s.color} text-white rounded text-xs font-semibold`,children:[s.icon," ",s.name]}),t.difficulty&&e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 rounded text-xs",children:t.difficulty==="easy"?"D·ªÖ":t.difficulty==="medium"?"Trung b√¨nh":"Kh√≥"})]}),e.jsx("h3",{className:"text-xl font-bold text-gray-800 mb-2",children:t.title||t.id}),t.description&&e.jsx("p",{className:"text-gray-600 mb-3",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-4 text-sm text-gray-500 mb-3",children:[e.jsxs("span",{children:["üìä ",t.questionCount||0," c√¢u h·ªèi"]}),t.usageCount>0&&e.jsxs("span",{children:["üë• ",t.usageCount," ng∆∞·ªùi ƒë√£ l√†m"]}),t.rating>0&&e.jsxs("span",{children:["‚≠ê ",t.rating.toFixed(1)," (",t.ratingCount||0," ƒë√°nh gi√°)"]}),t.creatorName&&e.jsxs("span",{children:["‚úçÔ∏è ",t.creatorName]}),e.jsxs("span",{children:["üìÖ ",A(t.createdAt)]}),t.estimatedTime>0&&e.jsxs("span",{children:["‚è±Ô∏è ~",t.estimatedTime," ph√∫t"]})]}),t.tags&&Array.isArray(t.tags)&&t.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:t.tags.map((c,x)=>e.jsx("span",{className:"px-2 py-1 bg-primary-100 text-primary-700 rounded-full text-xs",children:c},x))})]})})},t.id)})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx(I,{onClick:()=>u("quizTypeSelect")})})]})};export{ue as QuizListScreen};
//# sourceMappingURL=QuizListScreen-Mz3b84_c.js.map
