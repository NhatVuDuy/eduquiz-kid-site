{"version":3,"file":"QuizTypeSelectScreen-Df9Oabs9.js","sources":["../../src/screens/QuizTypeSelectScreen.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useFlowStore } from '../store/flowStore';\nimport { useLevelStore } from '../store/levelStore';\nimport { usePlayerStore } from '../store/playerStore';\nimport { QUIZ_TYPES, QUIZ_TYPE_METADATA } from '../models/level.js';\nimport { getQuizTypeStatsMap } from '../services/quizStatsService.js';\nimport { soundService } from '../services/soundService';\nimport { formatCompactNumber, formatRatingValue } from '../utils/numberFormat.js';\nimport { ScreenContainer, Header, SubjectCard, BackButton } from '../components/screen';\n\n/**\n * QuizTypeSelectScreen Component\n * Màn hình chọn loại bài test (Hệ thống, Cộng đồng, Cá nhân)\n */\nexport const QuizTypeSelectScreen = () => {\n  const { goToNext } = useFlowStore();\n  const { currentLevel, currentSubject, setCurrentQuizType } = useLevelStore();\n  const { currentPlayer } = usePlayerStore();\n  const [typeStats, setTypeStats] = useState({});\n  const [statsLoading, setStatsLoading] = useState(true);\n\n  const quizTypes = Object.values(QUIZ_TYPES).map(typeId => ({\n    ...QUIZ_TYPE_METADATA[typeId],\n    id: typeId,\n  }));\n\n  useEffect(() => {\n    if (currentLevel && currentSubject) {\n      loadTypeStats(currentLevel.id, currentSubject.id);\n    }\n  }, [currentLevel, currentSubject]);\n\n  const loadTypeStats = async (levelId, subjectId) => {\n    try {\n      setStatsLoading(true);\n      const stats = await getQuizTypeStatsMap(levelId, subjectId);\n      setTypeStats(stats || {});\n    } catch (error) {\n      console.error('Error loading quiz type stats:', error);\n    } finally {\n      setStatsLoading(false);\n    }\n  };\n\n  const handleSelectType = (quizType) => {\n    soundService.playClick();\n    setCurrentQuizType(quizType.id);\n    goToNext('quizList');\n  };\n\n  if (!currentLevel || !currentSubject) {\n    return (\n      <ScreenContainer className=\"flex items-center justify-center\">\n        <div className=\"text-center\">\n          <p className=\"text-xl text-gray-600 mb-4\">Chưa chọn cấp độ hoặc môn học!</p>\n          <BackButton onClick={() => goToNext('subjectSelect')} />\n        </div>\n      </ScreenContainer>\n    );\n  }\n\n  return (\n    <ScreenContainer>\n      <BackButton\n        inline\n        variant=\"ghost\"\n        label=\"← Quay lại\"\n        onClick={() => goToNext('subjectSelect')}\n        className=\"mb-2\"\n      />\n      <Header\n        title=\"Chọn loại bài test\"\n        subtitle={`${currentLevel.name} - ${currentSubject.name}`}\n        titleClassName=\"text-4xl\"\n      />\n\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n        {quizTypes.map((type, index) => {\n          const stats = typeStats[type.id] || {};\n          const statItems = [\n            { label: 'Bài test', value: statsLoading ? '…' : formatCompactNumber(stats.quizCount) },\n            { label: 'Lượt làm', value: statsLoading ? '…' : formatCompactNumber(stats.totalUsage) },\n            { label: 'Người học', value: statsLoading ? '…' : formatCompactNumber(stats.playerCount) },\n            { label: 'Đánh giá', value: statsLoading ? '…' : formatRatingValue(stats.averageRating) },\n          ];\n\n          return (\n            <SubjectCard\n              key={type.id}\n              icon={type.icon}\n              title={type.name}\n              description={type.description}\n              onClick={() => handleSelectType(type)}\n              delay={index * 0.1}\n              className={`bg-gradient-to-br ${type.color} text-white border-0`}\n              stats={statItems}\n              statsVariant=\"dark\"\n              titleClassName=\"text-2xl font-bold text-white mb-2\"\n              descriptionClassName=\"text-white/80\"\n              iconClassName=\"text-6xl mb-4 transform group-hover:scale-110 transition-transform duration-300 drop-shadow-lg\"\n            />\n          );\n        })}\n      </div>\n\n      {/* Nút Back ở footer */}\n      <div className=\"mt-8 text-center\">\n        <BackButton\n          onClick={() => goToNext('subjectSelect')}\n          label=\"← Quay lại\"\n        />\n      </div>\n    </ScreenContainer>\n  );\n};\n\n\n\n"],"names":["QuizTypeSelectScreen","goToNext","useFlowStore","currentLevel","currentSubject","setCurrentQuizType","useLevelStore","currentPlayer","usePlayerStore","typeStats","setTypeStats","useState","statsLoading","setStatsLoading","quizTypes","QUIZ_TYPES","typeId","QUIZ_TYPE_METADATA","useEffect","loadTypeStats","levelId","subjectId","stats","getQuizTypeStatsMap","error","handleSelectType","quizType","soundService","ScreenContainer","jsxs","jsx","BackButton","Header","type","index","statItems","formatCompactNumber","formatRatingValue","SubjectCard"],"mappings":"2nBAcO,MAAMA,EAAuB,IAAM,CACxC,KAAM,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CAAE,aAAAC,EAAc,eAAAC,EAAgB,mBAAAC,CAAA,EAAuBC,EAAA,EACvD,CAAE,cAAAC,CAAA,EAAkBC,EAAA,EACpB,CAACC,EAAWC,CAAY,EAAIC,EAAAA,SAAS,CAAA,CAAE,EACvC,CAACC,EAAcC,CAAe,EAAIF,EAAAA,SAAS,EAAI,EAE/CG,EAAY,OAAO,OAAOC,CAAU,EAAE,IAAIC,IAAW,CACzD,GAAGC,EAAmBD,CAAM,EAC5B,GAAIA,CAAA,EACJ,EAEFE,EAAAA,UAAU,IAAM,CACVf,GAAgBC,GAClBe,EAAchB,EAAa,GAAIC,EAAe,EAAE,CAEpD,EAAG,CAACD,EAAcC,CAAc,CAAC,EAEjC,MAAMe,EAAgB,MAAOC,EAASC,IAAc,CAClD,GAAI,CACFR,EAAgB,EAAI,EACpB,MAAMS,EAAQ,MAAMC,EAAoBH,EAASC,CAAS,EAC1DX,EAAaY,GAAS,EAAE,CAC1B,OAASE,EAAO,CACd,QAAQ,MAAM,iCAAkCA,CAAK,CACvD,QAAA,CACEX,EAAgB,EAAK,CACvB,CACF,EAEMY,EAAoBC,GAAa,CACrCC,EAAa,UAAA,EACbtB,EAAmBqB,EAAS,EAAE,EAC9BzB,EAAS,UAAU,CACrB,EAEA,MAAI,CAACE,GAAgB,CAACC,QAEjBwB,EAAA,CAAgB,UAAU,mCACzB,SAAAC,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAC,EAAAA,IAAC,IAAA,CAAE,UAAU,6BAA6B,SAAA,iCAA8B,QACvEC,EAAA,CAAW,QAAS,IAAM9B,EAAS,eAAe,CAAA,CAAG,CAAA,CAAA,CACxD,CAAA,CACF,SAKD2B,EAAA,CACC,SAAA,CAAAE,EAAAA,IAACC,EAAA,CACC,OAAM,GACN,QAAQ,QACR,MAAM,aACN,QAAS,IAAM9B,EAAS,eAAe,EACvC,UAAU,MAAA,CAAA,EAEZ6B,EAAAA,IAACE,EAAA,CACC,MAAM,qBACN,SAAU,GAAG7B,EAAa,IAAI,MAAMC,EAAe,IAAI,GACvD,eAAe,UAAA,CAAA,EAGjB0B,MAAC,OAAI,UAAU,wCACZ,WAAU,IAAI,CAACG,EAAMC,IAAU,CAC9B,MAAMZ,EAAQb,EAAUwB,EAAK,EAAE,GAAK,CAAA,EAC9BE,EAAY,CAChB,CAAE,MAAO,WAAY,MAAOvB,EAAe,IAAMwB,EAAoBd,EAAM,SAAS,CAAA,EACpF,CAAE,MAAO,WAAY,MAAOV,EAAe,IAAMwB,EAAoBd,EAAM,UAAU,CAAA,EACrF,CAAE,MAAO,YAAa,MAAOV,EAAe,IAAMwB,EAAoBd,EAAM,WAAW,CAAA,EACvF,CAAE,MAAO,WAAY,MAAOV,EAAe,IAAMyB,EAAkBf,EAAM,aAAa,CAAA,CAAE,EAG1F,OACEQ,EAAAA,IAACQ,EAAA,CAEC,KAAML,EAAK,KACX,MAAOA,EAAK,KACZ,YAAaA,EAAK,YAClB,QAAS,IAAMR,EAAiBQ,CAAI,EACpC,MAAOC,EAAQ,GACf,UAAW,qBAAqBD,EAAK,KAAK,uBAC1C,MAAOE,EACP,aAAa,OACb,eAAe,qCACf,qBAAqB,gBACrB,cAAc,gGAAA,EAXTF,EAAK,EAAA,CAchB,CAAC,CAAA,CACH,EAGAH,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACb,SAAAA,EAAAA,IAACC,EAAA,CACC,QAAS,IAAM9B,EAAS,eAAe,EACvC,MAAM,YAAA,CAAA,CACR,CACF,CAAA,EACF,CAEJ"}