{"version":3,"file":"QuizFilterScreen-xZ5DHtIR.js","sources":["../../src/screens/QuizFilterScreen.jsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useFlowStore } from '../store/flowStore';\nimport { useLevelStore } from '../store/levelStore';\nimport { loadLevels, loadSubjectsForLevel } from '../services/levelService.js';\nimport { getQuizTypeMetadata, QUIZ_TYPES } from '../models/level.js';\nimport { soundService } from '../services/soundService';\nimport { Card } from '../components/Card';\nimport { Button } from '../components/Button';\nimport { ScreenContainer, Header, BackButton, OptionButton } from '../components/screen';\n\n/**\n * QuizFilterScreen Component\n * Màn hình filter bài test theo môn hoặc loại\n * Cho phép xem tất cả bài test với filter\n */\nexport const QuizFilterScreen = () => {\n  const { goToNext } = useFlowStore();\n  const { \n    setFilterSubject, \n    setFilterQuizType,\n    filterSubject,\n    filterQuizType,\n    clearFilters,\n  } = useLevelStore();\n  const [levels, setLevels] = useState([]);\n  const [selectedLevel, setSelectedLevel] = useState(null);\n  const [subjects, setSubjects] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    loadLevelsData();\n  }, []);\n\n  useEffect(() => {\n    if (selectedLevel) {\n      loadSubjectsData();\n    }\n  }, [selectedLevel]);\n\n  const loadLevelsData = async () => {\n    try {\n      const loadedLevels = await loadLevels();\n      setLevels(loadedLevels);\n    } catch (error) {\n      console.error('Error loading levels:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadSubjectsData = async () => {\n    try {\n      const loadedSubjects = await loadSubjectsForLevel(selectedLevel.id);\n      setSubjects(loadedSubjects);\n    } catch (error) {\n      console.error('Error loading subjects:', error);\n    }\n  };\n\n  const handleApplyFilter = () => {\n    soundService.playClick();\n    goToNext('quizList');\n  };\n\n  const quizTypes = Object.values(QUIZ_TYPES).map(typeId => ({\n    ...getQuizTypeMetadata(typeId),\n    id: typeId,\n  }));\n\n  if (loading) {\n    return (\n      <ScreenContainer className=\"flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-6xl mb-4 animate-spin\">⏳</div>\n          <p className=\"text-xl text-gray-600\">Đang tải...</p>\n        </div>\n      </ScreenContainer>\n    );\n  }\n\n  return (\n    <ScreenContainer>\n      <BackButton\n        inline\n        variant=\"ghost\"\n        label=\"← Quay lại\"\n        onClick={() => goToNext('home')}\n        className=\"mb-2\"\n      />\n      <Header\n        title=\"Lọc bài test\"\n        subtitle=\"Chọn môn học hoặc loại bài test\"\n        titleClassName=\"text-4xl\"\n      />\n\n      <div className=\"space-y-6\">\n        {/* Filter by Subject */}\n        <Card>\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">\n            Lọc theo môn học\n          </h3>\n          \n          {/* Level selector */}\n          <div className=\"mb-4\">\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Chọn cấp độ:\n            </label>\n            <div className=\"grid grid-cols-3 gap-2\">\n              {levels.slice(0, 6).map((level) => (\n                <OptionButton\n                  key={level.id}\n                  label={level.name}\n                  icon={level.icon}\n                  selected={selectedLevel?.id === level.id}\n                  onClick={() => setSelectedLevel(level)}\n                  size=\"sm\"\n                />\n              ))}\n            </div>\n          </div>\n\n          {/* Subject selector */}\n          {selectedLevel && subjects.length > 0 && (\n            <div>\n              <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                Chọn môn:\n              </label>\n              <div className=\"grid grid-cols-2 gap-2\">\n                <OptionButton\n                  label=\"Tất cả môn\"\n                  selected={!filterSubject}\n                  onClick={() => setFilterSubject(null)}\n                  size=\"sm\"\n                />\n                {subjects.map((subject) => (\n                  <OptionButton\n                    key={subject.id}\n                    label={subject.name}\n                    icon={subject.icon}\n                    selected={filterSubject === subject.id}\n                    onClick={() => setFilterSubject(subject.id)}\n                    size=\"sm\"\n                  />\n                ))}\n              </div>\n            </div>\n          )}\n        </Card>\n\n        {/* Filter by Type */}\n        <Card>\n          <h3 className=\"text-lg font-semibold text-gray-800 mb-4\">\n            Lọc theo loại\n          </h3>\n          <div className=\"grid grid-cols-3 gap-2\">\n            <OptionButton\n              label=\"Tất cả\"\n              selected={!filterQuizType}\n              onClick={() => setFilterQuizType(null)}\n              size=\"sm\"\n            />\n            {quizTypes.map((type) => (\n              <OptionButton\n                key={type.id}\n                label={type.name}\n                icon={type.icon}\n                selected={filterQuizType === type.id}\n                onClick={() => setFilterQuizType(type.id)}\n                size=\"sm\"\n              />\n            ))}\n          </div>\n        </Card>\n\n        {/* Actions */}\n        <div className=\"flex gap-4\">\n          <Button\n            onClick={handleApplyFilter}\n            variant=\"primary\"\n            size=\"lg\"\n            className=\"flex-1\"\n          >\n            Áp dụng bộ lọc\n          </Button>\n          <Button\n            onClick={() => {\n              clearFilters();\n              setSelectedLevel(null);\n              setSubjects([]);\n            }}\n            variant=\"outline\"\n            size=\"lg\"\n          >\n            Xóa tất cả\n          </Button>\n        </div>\n      </div>\n\n      <BackButton onClick={() => goToNext('home')} />\n    </ScreenContainer>\n  );\n};\n\n\n\n"],"names":["QuizFilterScreen","goToNext","useFlowStore","setFilterSubject","setFilterQuizType","filterSubject","filterQuizType","clearFilters","useLevelStore","levels","setLevels","useState","selectedLevel","setSelectedLevel","subjects","setSubjects","loading","setLoading","useEffect","loadLevelsData","loadSubjectsData","loadedLevels","loadLevels","error","loadedSubjects","loadSubjectsForLevel","handleApplyFilter","soundService","quizTypes","QUIZ_TYPES","typeId","getQuizTypeMetadata","ScreenContainer","jsxs","jsx","BackButton","Header","Card","level","OptionButton","subject","type","Button"],"mappings":"gmBAeO,MAAMA,EAAmB,IAAM,CACpC,KAAM,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CACJ,iBAAAC,EACA,kBAAAC,EACA,cAAAC,EACA,eAAAC,EACA,aAAAC,CAAA,EACEC,EAAA,EACE,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAS,CAAA,CAAE,EACjC,CAACC,EAAeC,CAAgB,EAAIF,EAAAA,SAAS,IAAI,EACjD,CAACG,EAAUC,CAAW,EAAIJ,EAAAA,SAAS,CAAA,CAAE,EACrC,CAACK,EAASC,CAAU,EAAIN,EAAAA,SAAS,EAAI,EAE3CO,EAAAA,UAAU,IAAM,CACdC,EAAA,CACF,EAAG,CAAA,CAAE,EAELD,EAAAA,UAAU,IAAM,CACVN,GACFQ,EAAA,CAEJ,EAAG,CAACR,CAAa,CAAC,EAElB,MAAMO,EAAiB,SAAY,CACjC,GAAI,CACF,MAAME,EAAe,MAAMC,EAAA,EAC3BZ,EAAUW,CAAY,CACxB,OAASE,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,CAC9C,QAAA,CACEN,EAAW,EAAK,CAClB,CACF,EAEMG,EAAmB,SAAY,CACnC,GAAI,CACF,MAAMI,EAAiB,MAAMC,EAAqBb,EAAc,EAAE,EAClEG,EAAYS,CAAc,CAC5B,OAASD,EAAO,CACd,QAAQ,MAAM,0BAA2BA,CAAK,CAChD,CACF,EAEMG,EAAoB,IAAM,CAC9BC,EAAa,UAAA,EACb1B,EAAS,UAAU,CACrB,EAEM2B,EAAY,OAAO,OAAOC,CAAU,EAAE,IAAIC,IAAW,CACzD,GAAGC,EAAoBD,CAAM,EAC7B,GAAIA,CAAA,EACJ,EAEF,OAAId,QAECgB,EAAA,CAAgB,UAAU,mCACzB,SAAAC,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,6BAA6B,SAAA,IAAC,EAC7CA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,aAAA,CAAW,CAAA,CAAA,CAClD,CAAA,CACF,SAKDF,EAAA,CACC,SAAA,CAAAE,EAAAA,IAACC,EAAA,CACC,OAAM,GACN,QAAQ,QACR,MAAM,aACN,QAAS,IAAMlC,EAAS,MAAM,EAC9B,UAAU,MAAA,CAAA,EAEZiC,EAAAA,IAACE,EAAA,CACC,MAAM,eACN,SAAS,kCACT,eAAe,UAAA,CAAA,EAGjBH,EAAAA,KAAC,MAAA,CAAI,UAAU,YAEb,SAAA,CAAAA,OAACI,EAAA,CACC,SAAA,CAAAH,EAAAA,IAAC,KAAA,CAAG,UAAU,2CAA2C,SAAA,mBAEzD,EAGAD,EAAAA,KAAC,MAAA,CAAI,UAAU,OACb,SAAA,CAAAC,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,eAEhE,EACAA,EAAAA,IAAC,MAAA,CAAI,UAAU,yBACZ,SAAAzB,EAAO,MAAM,EAAG,CAAC,EAAE,IAAK6B,GACvBJ,EAAAA,IAACK,EAAA,CAEC,MAAOD,EAAM,KACb,KAAMA,EAAM,KACZ,SAAU1B,GAAe,KAAO0B,EAAM,GACtC,QAAS,IAAMzB,EAAiByB,CAAK,EACrC,KAAK,IAAA,EALAA,EAAM,EAAA,CAOd,CAAA,CACH,CAAA,EACF,EAGC1B,GAAiBE,EAAS,OAAS,UACjC,MAAA,CACC,SAAA,CAAAoB,EAAAA,IAAC,QAAA,CAAM,UAAU,+CAA+C,SAAA,YAEhE,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CACC,MAAM,aACN,SAAU,CAAClC,EACX,QAAS,IAAMF,EAAiB,IAAI,EACpC,KAAK,IAAA,CAAA,EAENW,EAAS,IAAK0B,GACbN,EAAAA,IAACK,EAAA,CAEC,MAAOC,EAAQ,KACf,KAAMA,EAAQ,KACd,SAAUnC,IAAkBmC,EAAQ,GACpC,QAAS,IAAMrC,EAAiBqC,EAAQ,EAAE,EAC1C,KAAK,IAAA,EALAA,EAAQ,EAAA,CAOhB,CAAA,CAAA,CACH,CAAA,CAAA,CACF,CAAA,EAEJ,SAGCH,EAAA,CACC,SAAA,CAAAH,EAAAA,IAAC,KAAA,CAAG,UAAU,2CAA2C,SAAA,gBAEzD,EACAD,EAAAA,KAAC,MAAA,CAAI,UAAU,yBACb,SAAA,CAAAC,EAAAA,IAACK,EAAA,CACC,MAAM,SACN,SAAU,CAACjC,EACX,QAAS,IAAMF,EAAkB,IAAI,EACrC,KAAK,IAAA,CAAA,EAENwB,EAAU,IAAKa,GACdP,EAAAA,IAACK,EAAA,CAEC,MAAOE,EAAK,KACZ,KAAMA,EAAK,KACX,SAAUnC,IAAmBmC,EAAK,GAClC,QAAS,IAAMrC,EAAkBqC,EAAK,EAAE,EACxC,KAAK,IAAA,EALAA,EAAK,EAAA,CAOb,CAAA,CAAA,CACH,CAAA,EACF,EAGAR,EAAAA,KAAC,MAAA,CAAI,UAAU,aACb,SAAA,CAAAC,EAAAA,IAACQ,EAAA,CACC,QAAShB,EACT,QAAQ,UACR,KAAK,KACL,UAAU,SACX,SAAA,gBAAA,CAAA,EAGDQ,EAAAA,IAACQ,EAAA,CACC,QAAS,IAAM,CACbnC,EAAA,EACAM,EAAiB,IAAI,EACrBE,EAAY,CAAA,CAAE,CAChB,EACA,QAAQ,UACR,KAAK,KACN,SAAA,YAAA,CAAA,CAED,CAAA,CACF,CAAA,EACF,QAECoB,EAAA,CAAW,QAAS,IAAMlC,EAAS,MAAM,CAAA,CAAG,CAAA,EAC/C,CAEJ"}