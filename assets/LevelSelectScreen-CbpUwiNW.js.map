{"version":3,"file":"LevelSelectScreen-CbpUwiNW.js","sources":["../../src/screens/LevelSelectScreen.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useFlowStore } from '../store/flowStore';\nimport { useLevelStore } from '../store/levelStore';\nimport { loadLevels } from '../services/levelService.js';\nimport { getLevelStatsMap } from '../services/quizStatsService.js';\nimport { soundService } from '../services/soundService';\nimport { formatCompactNumber, formatRatingValue } from '../utils/numberFormat.js';\nimport { ScreenContainer, Header, SubjectCard, BackButton } from '../components/screen';\n\n/**\n * LevelSelectScreen Component\n * Màn hình chọn cấp độ giáo dục\n */\nexport const LevelSelectScreen = () => {\n  const { goToNext } = useFlowStore();\n  const { setCurrentLevel } = useLevelStore();\n  const [levels, setLevels] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [levelStats, setLevelStats] = useState({});\n  const [statsLoading, setStatsLoading] = useState(true);\n\n  useEffect(() => {\n    loadLevelsData();\n    loadLevelStats();\n  }, []);\n\n  const loadLevelsData = async () => {\n    try {\n      const loadedLevels = await loadLevels();\n      setLevels(loadedLevels);\n    } catch (error) {\n      console.error('Error loading levels:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadLevelStats = async () => {\n    try {\n      setStatsLoading(true);\n      const stats = await getLevelStatsMap();\n      setLevelStats(stats || {});\n    } catch (error) {\n      console.error('Error loading level stats:', error);\n    } finally {\n      setStatsLoading(false);\n    }\n  };\n\n  const handleSelectLevel = (level) => {\n    soundService.playClick();\n    setCurrentLevel(level);\n    goToNext('subjectSelect');\n  };\n\n  if (loading) {\n    return (\n      <ScreenContainer className=\"flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"text-6xl mb-4 animate-spin\">⏳</div>\n          <p className=\"text-xl text-gray-600\">Đang tải...</p>\n        </div>\n      </ScreenContainer>\n    );\n  }\n\n  return (\n    <ScreenContainer>\n      <BackButton\n        inline\n        variant=\"ghost\"\n        label=\"← Quay lại\"\n        onClick={() => goToNext('home')}\n        className=\"mb-2\"\n      />\n      <Header\n        title=\"Chọn cấp độ\"\n        subtitle=\"Chọn cấp độ phù hợp với bạn\"\n        titleClassName=\"text-4xl\"\n      />\n\n      <div className=\"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4\">\n        {levels.map((level, index) => {\n          const stats = levelStats[level.id] || {};\n          const statItems = [\n            { label: 'Bài test', value: statsLoading ? '…' : formatCompactNumber(stats.quizCount) },\n            { label: 'Lượt làm', value: statsLoading ? '…' : formatCompactNumber(stats.totalUsage) },\n            { label: 'Người học', value: statsLoading ? '…' : formatCompactNumber(stats.playerCount) },\n            { label: 'Đánh giá', value: statsLoading ? '…' : formatRatingValue(stats.averageRating) },\n          ];\n\n          return (\n            <SubjectCard\n              key={level.id}\n              icon={level.icon}\n              title={level.name}\n              description={level.description}\n              onClick={() => handleSelectLevel(level)}\n              delay={index * 0.05}\n              className=\"h-full\"\n              stats={statItems}\n            />\n          );\n        })}\n      </div>\n\n      {/* Nút Back ở footer */}\n      <div className=\"mt-8 text-center\">\n        <BackButton\n          onClick={() => goToNext('home')}\n          label=\"← Quay lại\"\n        />\n      </div>\n    </ScreenContainer>\n  );\n};\n\n\n\n"],"names":["LevelSelectScreen","goToNext","useFlowStore","setCurrentLevel","useLevelStore","levels","setLevels","useState","loading","setLoading","levelStats","setLevelStats","statsLoading","setStatsLoading","useEffect","loadLevelsData","loadLevelStats","loadedLevels","loadLevels","error","stats","getLevelStatsMap","handleSelectLevel","level","soundService","ScreenContainer","jsxs","jsx","BackButton","Header","index","statItems","formatCompactNumber","formatRatingValue","SubjectCard"],"mappings":"+kBAaO,MAAMA,EAAoB,IAAM,CACrC,KAAM,CAAE,SAAAC,CAAA,EAAaC,EAAA,EACf,CAAE,gBAAAC,CAAA,EAAoBC,EAAA,EACtB,CAACC,EAAQC,CAAS,EAAIC,EAAAA,SAAS,CAAA,CAAE,EACjC,CAACC,EAASC,CAAU,EAAIF,EAAAA,SAAS,EAAI,EACrC,CAACG,EAAYC,CAAa,EAAIJ,EAAAA,SAAS,CAAA,CAAE,EACzC,CAACK,EAAcC,CAAe,EAAIN,EAAAA,SAAS,EAAI,EAErDO,EAAAA,UAAU,IAAM,CACdC,EAAA,EACAC,EAAA,CACF,EAAG,CAAA,CAAE,EAEL,MAAMD,EAAiB,SAAY,CACjC,GAAI,CACF,MAAME,EAAe,MAAMC,EAAA,EAC3BZ,EAAUW,CAAY,CACxB,OAASE,EAAO,CACd,QAAQ,MAAM,wBAAyBA,CAAK,CAC9C,QAAA,CACEV,EAAW,EAAK,CAClB,CACF,EAEMO,EAAiB,SAAY,CACjC,GAAI,CACFH,EAAgB,EAAI,EACpB,MAAMO,EAAQ,MAAMC,EAAA,EACpBV,EAAcS,GAAS,EAAE,CAC3B,OAASD,EAAO,CACd,QAAQ,MAAM,6BAA8BA,CAAK,CACnD,QAAA,CACEN,EAAgB,EAAK,CACvB,CACF,EAEMS,EAAqBC,GAAU,CACnCC,EAAa,UAAA,EACbrB,EAAgBoB,CAAK,EACrBtB,EAAS,eAAe,CAC1B,EAEA,OAAIO,QAECiB,EAAA,CAAgB,UAAU,mCACzB,SAAAC,EAAAA,KAAC,MAAA,CAAI,UAAU,cACb,SAAA,CAAAC,EAAAA,IAAC,MAAA,CAAI,UAAU,6BAA6B,SAAA,IAAC,EAC7CA,EAAAA,IAAC,IAAA,CAAE,UAAU,wBAAwB,SAAA,aAAA,CAAW,CAAA,CAAA,CAClD,CAAA,CACF,SAKDF,EAAA,CACC,SAAA,CAAAE,EAAAA,IAACC,EAAA,CACC,OAAM,GACN,QAAQ,QACR,MAAM,aACN,QAAS,IAAM3B,EAAS,MAAM,EAC9B,UAAU,MAAA,CAAA,EAEZ0B,EAAAA,IAACE,EAAA,CACC,MAAM,cACN,SAAS,8BACT,eAAe,UAAA,CAAA,EAGjBF,MAAC,OAAI,UAAU,uDACZ,WAAO,IAAI,CAACJ,EAAOO,IAAU,CAC5B,MAAMV,EAAQV,EAAWa,EAAM,EAAE,GAAK,CAAA,EAChCQ,EAAY,CAChB,CAAE,MAAO,WAAY,MAAOnB,EAAe,IAAMoB,EAAoBZ,EAAM,SAAS,CAAA,EACpF,CAAE,MAAO,WAAY,MAAOR,EAAe,IAAMoB,EAAoBZ,EAAM,UAAU,CAAA,EACrF,CAAE,MAAO,YAAa,MAAOR,EAAe,IAAMoB,EAAoBZ,EAAM,WAAW,CAAA,EACvF,CAAE,MAAO,WAAY,MAAOR,EAAe,IAAMqB,EAAkBb,EAAM,aAAa,CAAA,CAAE,EAG1F,OACEO,EAAAA,IAACO,EAAA,CAEC,KAAMX,EAAM,KACZ,MAAOA,EAAM,KACb,YAAaA,EAAM,YACnB,QAAS,IAAMD,EAAkBC,CAAK,EACtC,MAAOO,EAAQ,IACf,UAAU,SACV,MAAOC,CAAA,EAPFR,EAAM,EAAA,CAUjB,CAAC,CAAA,CACH,EAGAI,EAAAA,IAAC,MAAA,CAAI,UAAU,mBACb,SAAAA,EAAAA,IAACC,EAAA,CACC,QAAS,IAAM3B,EAAS,MAAM,EAC9B,MAAM,YAAA,CAAA,CACR,CACF,CAAA,EACF,CAEJ"}